# 伪造安装模块（com.install.appinstall.xl）
基于Android底层Hook技术的应用防护XP模块，核心实现应用安装状态伪造，拦截恶意安装检测，绕过应用强制安装限制，保护设备应用列表隐私。

### 核心作用
拦截应用的PackageManager/文件/命令行/网络等多维度安装检测，返回自定义伪造结果（已安装/未安装），防止应用因检测特定包而限制功能、强制退出或强制推送下载。

### 举个栗子
打开软件A后，被要求强制下载安装软件B才能使用核心功能，使用本模块可伪造“软件B已安装”的状态，无需实际安装即可正常使用软件A。

## ✨ 适用场景
- 保护隐私：拒绝应用恶意查询设备已安装应用列表
- 绕过限制：突破应用“必须安装指定APP才能使用”的强制要求
- 反检测：规避应用商店/第三方应用的安装状态检测
- 便捷使用：无需ROOT也可通过LSPatch实现功能（非ROOT方案）

## 🚀 核心功能
### 核心能力
1. **双模式状态伪造**：自由切换「已安装/未安装」模式，自动捕获目标应用的包检测请求并返回伪造结果
2. **全场景检测拦截**：支持PackageManager查询、文件系统、命令行（pm/dumpsys）、网络请求等检测方式拦截，适配应用插件检测
3. **检测退出拦截**：拦截应用因检测到伪造包触发的退出行为，支持**静默拦截/手动确认**双模式
4. **自动权限伪造**：无需手动授权，自动伪造QUERY_ALL_PACKAGES等检测相关核心权限
5. **配置持久化**：悬浮窗位置、拦截状态、伪造模式等配置自动保存，重启应用/设备不丢失

### 便捷操作
- 悬浮窗快捷配置：点击调起配置面板，长按隐藏/清理/重置，拖拽调整位置
- 历史记录记忆：重复检测场景自动静默拦截，无需重复确认
- 一键清理：快速清空已捕获的包检测记录及伪造缓存

![伪造安装01](https://github.com/user-attachments/assets/fdde2c55-9321-4d12-9232-0672d5f69f03)
![伪造安装02](https://github.com/user-attachments/assets/25125782-7138-41e6-b099-fe128dedd434)
![伪造安装03](https://github.com/user-attachments/assets/94c96a89-7526-4274-bca5-6fc211a3be16)

## 📋 前置条件
1. 已ROOT设备：安装**LSPosed框架**（推荐）/EdXposed框架
2. 未ROOT设备：安装**LSPatch框架**（无需解锁BL/ROOT）
3. 系统版本：Android 8.0+（API 26）~ Android 16（API 36）
4. 目标应用：未加固（加固应用会屏蔽XP模块，导致功能失效）

## 🛠 安装教程
### 1. ROOT方案（LSPosed/EdXposed）
1. 下载最新版APK：[Releases 页面](https://github.com/Xposed-Modules-Repo/com.install.appinstall.xl/releases)
2. 安装APK后，打开LSPosed → 模块 → 找到「伪造安装模块」→ 开启模块
3. 勾选需要适配的**目标应用**（仅勾选第三方应用，禁止勾选系统应用）
4. 重启目标应用（或重启设备），模块即可生效

### 2. 非ROOT方案（LSPatch）
1. 打开LSPatch → 添加应用 → 选择「内嵌模式/本地模式」
2. 找到「伪造安装模块」并勾选，制作新的应用安装包
3. 安装制作后的新APK，启动后模块自动生效（无ROOT/无框架也可使用）
> 注意：制作前请确认目标应用**无加固、无签名校验**，否则会制作失败

## 📌 功能使用指南
### 悬浮窗操作（核心操作入口）
| 操作方式       | 功能效果                                                         |
|----------------|------------------------------------------------------------------|
| 点击悬浮窗     | 弹出配置面板：切换伪造模式（已安装/未安装）、开启/关闭退出拦截    |
| 长按悬浮窗     | 弹出菜单：隐藏悬浮窗（重启应用恢复）、清理包列表、重置所有配置    |
| 拖拽悬浮窗     | 自由调整位置，调整后自动保存，重启后保持最新位置                 |

### 核心功能使用
1. **伪造安装状态**：点击悬浮窗→切换「已安装/未安装」→重启目标应用/刷新页面，立即生效
2. **拦截退出行为**：配置面板开启「拦截退出」，应用因检测伪造包触发退出时会自动拦截（默认静默拦截）
3. **清理检测记录**：长按悬浮窗→「清理包列表」，清空已捕获的检测包记录、伪造缓存，解决检测异常问题
4. **重置配置**：长按悬浮窗→「重置配置」，恢复模块默认设置，捕获的记录回到初始状态

## ⚠️ 注意事项
1. ❌ 严禁对**系统应用**启用模块，会导致系统崩溃、功能异常
2. 📱 目标应用无响应/检测失效：清理包列表 → 刷新应用 → 重启设备
3. 📁 模块配置文件路径：`/data/data/目标应用包名/files/install_fake_config.json`（卸载应用/清理数据会自动删除/分身应用会自动重置路径到对应位置如:`/data/user/0/分身应用主包名/virtual/data/user/0/实际使用的分身包名/files/install_fake_config.json`）
4. 🚫 加固应用会屏蔽XP模块，本模块对加固应用**可能无效**
5. 📌 部分应用采用自研检测技术，模块可能无法完全拦截（可反馈日志与应用优化适配）

## ❓ 常见问题排查
### Q：模块启用后无悬浮窗？
A：1. 确认目标应用已重启(冷启动)；2. 检查是否误隐藏悬浮窗（重启应用即可恢复）；3. 确认LSPosed中已勾选目标应用

### Q：应用仍提示「未安装指定应用」？
A：1. 切换「已安装」模式并重启目标应用；2. 清理包列表后重新打开应用；3. 检查目标应用是否为加固应用；4. 目标应用可能采用自研检测技术

### Q：拦截退出功能无效？
A：1. 确认配置面板中「拦截退出」已开启；2. 部分应用退出方式为自研，可反馈应用包名优化适配

### Q：悬浮窗无法点击/被其他弹窗覆盖？
A：悬浮窗已尽努力最大化提高层级，若被应用原生对话框/弹窗覆盖，关闭对应弹窗即可正常操作

## 📜 免责声明
本模块仅用于**技术学习和研究**，请勿用于商业用途或非法场景。
使用本模块过程中，若出现设备故障、应用异常、数据丢失等问题，作者不承担任何法律责任。
